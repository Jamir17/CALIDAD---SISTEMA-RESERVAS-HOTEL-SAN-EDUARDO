{% extends "principal.html" %}

{% block head %}
  {{ super() }}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/respaldo.css') }}">
{% endblock %}

{% block content %}
<div class="container py-3">

  <h4 class="title-section">Gestión de respaldos de base de datos</h4>

  <div class="toolbar">
    <form action="{{ url_for('respaldo.ejecutar_respaldo') }}" method="POST">
      <button class="btn-main">
        <!-- ICONO BASE DE DATOS SVG -->
        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
          <ellipse cx="12" cy="5" rx="9" ry="3"/>
          <path d="M3 5v6c0 1.7 4 3 9 3s9-1.3 9-3V5"/>
          <path d="M3 11v6c0 1.7 4 3 9 3s9-1.3 9-3v-6"/>
        </svg>
        Respaldar Ahora
      </button>
    </form>

    <span class="schedule-info">
      <!-- ICONO RELOJ SVG -->
      <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none"/>
        <path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" fill="none"/>
      </svg>
      Respaldos programados: <strong>02:00 a.m.</strong>
    </span>
  </div>

  <div class="table-wrapper">
    <table class="table table-hover align-middle">
      <thead>
        <tr>
          <th>Fecha</th>
          <th>Versión</th>
          <th>Respaldado</th>
          <th>Estado</th>
          <th>Descargar</th>
        </tr>
      </thead>
      <tbody>
        {% for r in registros %}
        <tr>
          <td>{{ r.fecha }}</td>
          <td>4.0.0.{{ registros|length - loop.index0 }}</td>
          
          <!-- ✅ Check verde SVG -->
          <td>
            <svg class="icon-success" viewBox="0 0 24 24">
              <path d="M20 6L9 17l-5-5" stroke="currentColor" stroke-width="2" fill="none"/>
            </svg>
          </td>

          <!-- ✅ Check verde :) -->
          <td>
            <svg class="icon-success" viewBox="0 0 24 24">
              <path d="M20 6L9 17l-5-5" stroke="currentColor" stroke-width="2" fill="none"/>
            </svg>
          </td>

          <!-- ⬇ Botón Descargar -->
          <td>
            <a class="btn-download"
               href="{{ url_for('respaldo.descargar_respaldo', nombre=r.nombre) }}"
               title="Descargar respaldo">
              <svg width="16" height="16" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2">
                <path d="M12 5v14M5 12l7 7 7-7"/>
                <path d="M5 19h14" stroke-linecap="round"/>
              </svg>
            </a>
          </td>
        </tr>
        {% else %}
        <tr>
          <td colspan="5" class="empty-state">No hay respaldos aún.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

</div>
{% endblock %}
